NestJS를 배우기 전에
===

## Node.js

`Nest`는 `Node.js`를 기반으로 동작합니다.

정확히는 `Nest`로 작성한 소스코드를 `Node.js` 기반 프레임워크인 `Express`나 `Fastify`에서 실행이 가능한 자바스크립트 소스코드로 **컴파일해 주는 역할을 합니다.**

`Node.js`의 정의는 다음과 같습니다. 

> Node.js는 Chrome V8 JavaScript 엔진으로 빌드 된 JavaScript 런타임입니다.

<br>

### 왜 등장하게 되었을까?

`Node.js`는 독립적인 언어가 아닌 스크립트 언어입니다. 그렇기 때문에 특정한 프로그램 안에서만 동작하는 언어입니다.

즉, 자바스크립트는 브라우저가 없다면 사용할 수 없는 언어였습니다.

하지만 `Node.js`가 등장하면서 브라우저에서만 사용할 수 있었던 자바스크립트를 **브라우저 밖에서도 사용할 수 있게 되었습니다.(런타임을 제공)**

이것이 `Node.js`가 등장하게 된 이유입니다. 이로 인해 브라우저와 무관한 프로그램을 만들 수 있게 되었으며 **자바스크립트를 이용하여 웹 서버를 만들 수 있게 된 것입니다.**

<br>

### 특징

`Node.js`는 **단일 쓰레드에서 구동되는 non-blocking I/O 이벤트 기반 비동기 방식**이라는 특징을 가지고 있습니다.

작업 요청이 한꺼번에 들어올 때 각 작업을 처리하기 위한 쓰레드를 만들고 할당하는 방식을 **멀티 쓰레드 방식이라고 합니다.**

멀티 쓰레드 방식은 여러 작업을 동시에 처리하므로 작업속도가 빠른 장점이 있지만, 공유 자원을 관리하는 노력이 많이 들고 `Lock`을 항상 주의하며 작업을 해야 합니다.

`Node.js`는 멀티 쓰레드 방식과는 다르게 **하나의 쓰레드에서 작업을 처리합니다.**

단일 쓰레드이지만 **백 그라운드에서는 쓰레드 풀을 구성해 작업을 처리해나갑니다.** 즉 개발자가 직접 쓰레드 풀을 관리하지 않고 `Node.js`에게 위임을 하는 것입니다. 내부적으로는 `Node.js`의 `libuv`가 그 역할을 해주고 있습니다.

> libuv는 Node.js에서 사용하는 비동기 I/O 라이브러리다. 이 라이브러리는 C로 작성되었고 윈도우나 리눅스 커널을 추상화한다. 커널을 사용하여 처리할 수 있는 비동기 작업을 발견하면 바로 커널로 작업을 넘겨버린다. 이후 이 작업들이 종료되어 커널로부터 시스템 콜을 받으면 이벤트 루프에 콜백을 등록한다. 만약 커널이 지원하지 않는 작업일 경우 별도의 쓰레드에서 작업을 처리한다.

<br>

### Node.js의 장단점

앞에서 설명한 단일 쓰레드 이벤트 기반 비동기 방식은 서버의 자원에 크게 부하가 작습니다. 하지만 **하나의 쓰레드를 사용하기 때문에 하나의 쓰레드에 문제가 생기게 되면 애플리케이션 전체가 오류를 일으킬 위험이 있습니다.**

또한 `Node.js`는 컴파일러 언어의 처리속도에 비해 그 성능이 떨어집니다. 그 이유는 자바스크립트가 **인터프리터 언어**이기 때문에 코드를 한줄 한줄 읽으면서 처리 하기 때문입니다.

하지만 V8엔진의 성능이 계속해서 증가하고 있기 때문에 추후 점점 개선될 거라 기대해봅니다.

<br>

## 이벤트 루프

추 후 `Node.js`를 Deep Dive하게 될 때 Study 예정

<br>

## 데코레이터

`Nest`는 데코레이터를 적극 활용합니다. 데코레이터를 잘 사용하면 **관심사를 분리하고 관점지향 프로그래밍을 적용한 코드를 작성할 수 있게 됩니다.**

타입스크립트의 데코레이터는 `Java`의 어노테이션과 유사한 기능을 하며 Class, method, 접근자(`get`, `set`), 프로퍼티, 매개변수에 적용이 가능합니다.

각 요소의 선언부 앞에 `@`로 시작하는 데코레이터를 선언하면 해당 코드와 데코레이터로 구현된 코드를 함께 실행할 수 있습니다.

타입스크립트 스팩에서는 아직 데코레이터는 **실험적인 기능**이기 때문에 사용을 하려면 프로젝트 루트의 `tsconfig.json` 파일에 설정을 추가해야 합니다.

```json
{
  "compilerOptions": {
        ...
    "experimentalDecorators": true,
        ...
  }
}
```